


### 公网ip:
```bash
curl cip.cc # 查看公网Ip
curl ifconfig.me # 查看公网Ip
ifconfig -a #查看Linux的内网IP地址

```

### 几个重要的配置文件：
```/etc/resolv.conf ```  
```/etc/sysconfig/network-scripts/ifcfg-ens33```
```bash
$ cat /etc/resolv.conf 
# Generated by NetworkManager
nameserver 8.8.8.8
nameserver 114.114.114.114

$ cat /etc/sysconfig/network-scripts/ifcfg-ens33 #可以没有DNS设置
TYPE="Ethernet"
PROXY_METHOD="none"
BROWSER_ONLY="no"
BOOTPROTO="static" #必须设置
DEFROUTE="yes"
IPV4_FAILURE_FATAL="no"
IPV6INIT="yes"
IPV6_AUTOCONF="yes"
IPV6_DEFROUTE="yes"
IPV6_FAILURE_FATAL="no"
IPV6_ADDR_GEN_MODE="stable-privacy"
NAME="ens33"
UUID="1b0b9593-650f-4276-b257-86bc51b88b01"
DEVICE="ens33"
IPADDR="192.168.5.100" #必须设置
GATEWAY="192.168.5.2" #必须设置
ONBOOT="yes" #必须设置



#编辑之后别忘了重启
systemctl restart network

```
### dns相关：

```bash
host -a baidu.com  #
[root@centos ~]#  host -a baidu.com
Trying "baidu.com"
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 52828
;; flags: qr rd ra; QUERY: 1, ANSWER: 8, AUTHORITY: 5, ADDITIONAL: 9

;; QUESTION SECTION:
;baidu.com.			IN	ANY

;; ANSWER SECTION:
baidu.com.		1187	IN	SOA	dns.baidu.com. sa.baidu.com. 2012145946 300 300 2592000 7200
baidu.com.		563	IN	A	110.242.68.66
baidu.com.		563	IN	A	39.156.66.10
baidu.com.		53855	IN	NS	dns.baidu.com.
baidu.com.		53855	IN	NS	ns3.baidu.com.
baidu.com.		53855	IN	NS	ns2.baidu.com.
baidu.com.		53855	IN	NS	ns4.baidu.com.
baidu.com.		53855	IN	NS	ns7.baidu.com.

;; AUTHORITY SECTION:
baidu.com.		53855	IN	NS	ns7.baidu.com.
baidu.com.		53855	IN	NS	ns4.baidu.com.
baidu.com.		53855	IN	NS	ns3.baidu.com.
baidu.com.		53855	IN	NS	ns2.baidu.com.
baidu.com.		53855	IN	NS	dns.baidu.com.

;; ADDITIONAL SECTION:
dns.baidu.com.		229	IN	A	110.242.68.134
ns2.baidu.com.		17206	IN	A	220.181.33.31
ns3.baidu.com.		12849	IN	A	112.80.248.64
ns3.baidu.com.		12849	IN	A	36.152.45.193
ns4.baidu.com.		33256	IN	A	14.215.178.80
ns4.baidu.com.		33256	IN	A	111.45.3.226
ns7.baidu.com.		23056	IN	A	180.76.76.92
ns7.baidu.com.		18540	IN	AAAA	240e:940:603:4:0:ff:b01b:589a
ns7.baidu.com.		18540	IN	AAAA	240e:bf:b801:1002:0:ff:b024:26de

[root@centos ~]# ping baidu.com
PING baidu.com (39.156.66.10) 56(84) bytes of data.
64 bytes from 39.156.66.10 (39.156.66.10): icmp_seq=1 ttl=128 time=50.8 ms
64 bytes from 39.156.66.10 (39.156.66.10): icmp_seq=2 ttl=128 time=53.4 ms
^C
--- baidu.com ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1002ms
rtt min/avg/max/mdev = 50.840/52.144/53.449/1.324 ms
[root@centos ~]# 

```
### /etc/resolv.conf文件中的search项作用 
refered to : https://www.shuzhiduo.com/A/x9J2Q7egz6/  
DNS配置文件如下
```bash
# vi /etc/resolv.conf
# Generated by NetworkManager
search openstack.local dev.com example.local
nameserver 192.168.122.21
```
例1：查询主机名，因为主机名后面没有点，就认为是主机名，所以先添加search里的每一项依次组成FQDN（完全合格域名）来查询，完全合格域名查询未找到，就再认为主机名是完全合格域名来查询
```bash
# host -a centos7-bind-1
Trying "centos7-bind-1.openstack.local"
Trying "centos7-bind-1.dev.com"
Trying "centos7-bind-1.example.local"
Trying "centos7-bind-1"
;; connection timed out; no servers could be reached
```


### 
https://mp.weixin.qq.com/s/saivLvkF0watg2nHxrO5-Q
```bash

ip link set x up # Bring up interface x. ip link set lo up
ip link set x down  # Bring down interface x.


ip link add type veth #添加一对veth pair

ip netns add ns0
ip netns add ns1

ip link set veth0 netns ns0   #将 veth0 加入到 ns0，将 veth1 加入到 XX namespace 中
ip link set veth1 netns ns1

ip netns exec ns0 ip link set veth0 up  #启用
ip netns exec ns1 ip link set veth1 up

ip netns exec ns0 ip addr #查看  ip -n ns0 addr
ip netns exec ns1 ip addr

ip netns exec ns0 ip addr add 192.0.0.1/24 dev veth0 
ip netns exec ns1 ip addr add 192.0.0.2/24 dev veth1


docker network create -d bridge --subnet "192.168.2.0/24" --gateway "192.168.2.1" br0   
docker network ls
docker run -it --name b1 --network br0 busybox


[root@localhost ~]# docker run -it --name t1 --network bridge --rm busybox
/ # cat /etc/hosts
127.0.0.1 localhost

```



###防火墙设置
```bash

systemctl disable firewalld 
systemctl restart network 
sestatus  #查看
setencforce 0  #关闭防火墙

```

### iptables, dos攻击：
```bash

iptables -L -n #查看

#https://blog.csdn.net/song123sh/article/details/124229841
# 防止dos攻击 白名单 + iptables + 安全漏洞 + 隐藏源ip
iptables -I INPUT -p tcp -dport 80 -m state -state NEW -m recent -set
iptables -I INPUT -p tcp -dport 80 -m state-state NEW -m recent -update -seconds 30 -hitcount 10 j DROP  #封杀每30秒与80端口建立连接超过10个的IP地址
```



### mtu, mss, 滑动窗口 拥塞窗口
```bash
$ ping -s 1460 -M do baidu.com 
[root@centos ~]# ping -s 1500 -M do baidu.com
PING baidu.com (110.242.68.66) 1500(1528) bytes of data.
ping: local error: Message too long, mtu=1500
ping: local error: Message too long, mtu=1500

# 是网络的最大传输单元,最大传输单元(MaximumTransmissionUnit，MTU)
# https://tsov.net/uupee/17420/
ifconfig ens33 mtu 1488 up #设置mtu大小
netstat -i # 查看各个网卡的mtu大小

# https://www.jianshu.com/p/399049fa1648
# MSS = MTU - IP header头大小 - TCP 头大小
[root@master01 ~]# netstat -i
Kernel Interface table
Iface             MTU    RX-OK RX-ERR RX-DRP RX-OVR    TX-OK TX-ERR TX-DRP TX-OVR Flg
docker0          1500        0      0      0 0             0      0      0      0 BMU
ens33            1500     1621      0      0 0          1094      0      0      0 BMRU
lo              65536   391996      0      0 0        391996      0      0      0 LRU
virbr0           1500        0      0      0 0             0      0      0      0 BMU


```


###  tcp 网络缓冲区大小：
```bash
cat /proc/sys/net/core/rmem_default
cat /proc/sys/net/core/wmem_default
cat /proc/sys/net/core/rmem_max  # tcp 或udp收发缓冲区最大值
cat /proc/sys/net/ipv4/tcp_wmem  # tcp 发送缓冲区的默认值
4096	16384	4194304   #//第一个表示最小值，第二个表示默认值，第三个表示最大值。
cat /proc/sys/net/ipv4/tcp_rmem

/proc/sys/net/


yum install speedtest-cli -y #测速包
ifconfig 
ens33: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 192.168.5.100  netmask 255.255.255.0  broadcast 192.168.5.255
        inet6 fe80::b750:3003:9565:df7d  prefixlen 64  scopeid 0x20<link>
        ether 00:0c:29:09:ff:98  txqueuelen 1000  (Ethernet)
        RX packets 808725  bytes 95545448 (91.1 MiB)   #收包和收包字节数
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 3475013  bytes 8339504836 (7.7 GiB)  #发包和收发字节数
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

#实时监控 
 watch -n 1 -d ifconfig ens33 @
 yum install iftop -y 
 iftop
 iftop -i ens33
 

```


Q: 不能操作 /etc/sysconfig/network-scripts/ifcfg-ens33?   
A: root 登录 su root